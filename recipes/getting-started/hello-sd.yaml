# Hello SD â€” Minimal Stable Diffusion recipe
# Tests that SD WebUI is running and generates a simple image.

name: "hello-sd"
version: "1.0"
description: "Generate a single image with Stable Diffusion"

inputs:
  - name: "prompt"
    type: "string"
    required: true
    description: "Image description"

  - name: "output_path"
    type: "path"
    default: "./hello-sd-output.png"
    description: "Where to save the image"

steps:
  - id: "generate"
    name: "Generate image"
    tool: "sd_client"
    action: "txt2img"
    inputs:
      prompt: "{{inputs.prompt}}"
      negative_prompt: "blurry, low quality, text, watermark"
      width: 512
      height: 512
      steps: 20

  - id: "save"
    name: "Save image"
    tool: "file_ops"
    action: "copy"
    inputs:
      source: "{{steps.generate.outputs.primary}}"
      destination: "{{inputs.output_path}}"

cleanup:
  on_success:
    - action: "delete"
      path: "{{temp_dir}}"
  on_failure:
    - action: "preserve"
      path: "{{temp_dir}}"
      reason: "debug"

# Usage:
# python -m localforge run recipes/getting-started/hello-sd.yaml \
#   --input prompt="a beautiful sunset over mountains" --auto-approve
